---
import EvaluationResult from '~/components/core/EvaluationResultComponent';
import Layout from '~/layouts/PageLayout.astro';

/// allows for this  /evaluations/view.asp?Subject=&CallNumber=&LName=&Sort=0&ID=934
// redirect with a permanent to goog

const { request } = Astro;

const url = new URL(request.url);
const searchParams = url.searchParams;

const DB = Astro.locals.runtime.env.DB;

let response = await DB.prepare(`SELECT * FROM evaluations where ID = ?`).bind(searchParams.get('ID')).all();

// check for results length

let evaluation = response.results[0];
---

<Layout metadata={{ title: 'Evaluation' }}>
  <div class="container mx-auto">
    <h1 class="text-3xl font-bold text-center mt-8">Evaluation</h1>
    <EvaluationResult evaluation={evaluation} />
  </div>
</Layout>
